# Getting Started - Company Management System

Quick start guide for new developers working with the Closepay Member Base App company management system.

## Overview

The Closepay Member Base App uses a **company management system** where each company is identified by:
- **`companyInitial`**: Primary identifier (uppercase, e.g., `TKIFTP`, `MB`, `P2L`)
- **`companyId`**: Secondary identifier (kebab-case, e.g., `tki-ftp`, `mb`, `p2l`) - Auto-generated from `companyInitial`

## Quick Start

### Prerequisites

- Node.js >= 20
- Python 3.x (for app manager tools)
- Git

### Adding a New Company

There are **3 ways** to add a new company:

#### 1. Using GUI Tool (Recommended for Beginners)

**Windows:**
```batch
cd apps\member-base\tools\app-manager
python main.py
```

**Linux/Mac:**
```bash
cd apps/member-base/tools/app-manager
python3 main.py
```

Steps:
1. Click **"Add Tenant"** button
2. Enter **Company Initial** (e.g., `TKIFTP`, `MB`, `P2L`) - PRIMARY IDENTIFIER
3. Enter **App Name** (e.g., `My Company App`)
4. Enter **Package Name** (e.g., `com.closepay.mycompany`) - Manual entry, NOT auto-generated
5. Enter **Logo Path** (optional, e.g., `assets/logo.png` or URL)
6. Select **Home Variant** (dashboard, simple, member, custom)
7. Configure enabled features/plugins
8. Click **"Save"**

#### 2. Using CLI Tool

**Windows:**
```batch
cd apps\member-base\tools\app-manager
manage.bat create-tenant MYCOMPANY "My Company App" --package-name com.closepay.mycompany
```

**Linux/Mac:**
```bash
cd apps/member-base/tools/app-manager
./manage.sh create-tenant MYCOMPANY "My Company App" --package-name com.closepay.mycompany
```

#### 3. Manual Edit (Advanced)

1. Edit `apps/member-base/tools/app-manager/tenants.json`
2. Add new tenant entry:
```json
{
  "my-company": {
    "id": "my-company",
    "companyInitial": "MYCOMPANY",
    "name": "My Company",
    "role": "member",
    "theme": {
      "primary": "#0066CC",
      "primaryDark": "#0052A3",
      "primaryLight": "#E6F2FF"
    },
    "homeVariant": "member",
    "enabledFeatures": [],
    "homeTabs": []
  }
}
```
3. Validate: `python app_manager.py validate`

## Company Initial Format

### Valid Formats

- ✅ `TKIFTP` - Uppercase letters
- ✅ `MB` - Short codes
- ✅ `P2L` - Letters + numbers
- ✅ `COMPANY_NAME` - Letters + underscores

### Invalid Formats

- ❌ `tki-ftp` - Must be uppercase (no dashes)
- ❌ `123ABC` - Cannot start with number
- ❌ `Company Name` - Cannot contain spaces
- ❌ `company@123` - Cannot contain special characters (except underscore)

### Rules

1. **Length**: 1-20 characters
2. **Characters**: Only uppercase letters (A-Z), numbers (0-9), and underscores (_)
3. **Start**: Must start with a letter
4. **Format**: Uppercase recommended (e.g., `TKIFTP`, `MB`)

## Common Tasks

### Generate App Repository

After adding a company, generate its app repository:

**GUI:**
1. Select tenant in list
2. Click **"Generate App"** button

**CLI:**
```bash
# Generate in main repo (apps/my-company/)
manage.bat generate my-company

# Generate standalone repo (custom location)
manage.bat generate my-company --output "D:\Projects\my-company-app"
```

### Sync Configuration

After updating tenant config, sync to app config:

```bash
manage.bat sync my-company
```

### List Companies

```bash
manage.bat list tenants
```

### Validate Configuration

```bash
manage.bat validate
```

## File Structure

```
apps/member-base/
├── tools/app-manager/
│   ├── tenants.json          # Company configurations
│   ├── main.py               # GUI tool
│   ├── app_manager.py        # CLI tool
│   └── repo_generator.py     # Repository generator
└── config/
    └── app.config.ts         # Current app config (auto-generated)
```

## Troubleshooting

### Error: "Company initial is required"

**Solution**: Make sure `companyInitial` field exists in `tenants.json`. It will be auto-generated from `tenant_id` if not provided.

### Error: "Company initial contains invalid characters"

**Solution**: Check format - must be uppercase alphanumeric (A-Z, 0-9, _), must start with a letter.

### Error: "Tenant ID mismatch"

**Solution**: Make sure the JSON key matches the `id` field in the tenant object.

### App Config Not Updating

**Solution**: Run sync command:
```bash
manage.bat sync my-company
```

## Next Steps

- See [EXAMPLES.md](./EXAMPLES.md) for detailed examples
- See [README.md](../README.md) for project overview
- See [app-manager README.md](../apps/member-base/tools/app-manager/README.md) for tool documentation

## Getting Help

- Check validation errors: `python app_manager.py validate`
- Check status: `python app_manager.py status`
- Review examples in `docs/EXAMPLES.md`

